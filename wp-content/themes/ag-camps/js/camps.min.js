var debounceFetchTimeout;document.addEventListener("DOMContentLoaded",(function(){new tippy("#add-kid",{interactive:!0,theme:"dark",allowHTML:!0,content:document.querySelector("#enfantinputs"),placement:"top",showOnCreate:!0});var e=Array.from(document.querySelector("#full-days").options).map((function(e){return e.value})),t={};function n(e){return("0"+e).slice(-2)}Array.from(document.querySelector("#valid-days").options).forEach((function(e){t[e.value]=e.innerHTML}));var r=flatpickr("#calendrier",{inline:!0,mode:"multiple",dateFormat:"Y-m-d",enable:Array.from(document.querySelector("#valid-days").options).map((function(e){return e.value})),onChange:function(e,t,n){debouceFetch()},onDayCreate:function(r,c,o,a){var i=a.dateObj,d=i.getFullYear()+"-"+n(i.getMonth()+1)+"-"+n(i.getDate());-1!==e.indexOf(d)&&(a.className+=" date-full"),-1!==Object.keys(t).indexOf(d)&&a.insertAdjacentHTML("beforeEnd",'<span title="'.concat(t[d]," place").concat(t[d]>1?"s":""," disponible").concat(t[d]>1?"s":"",'.">').concat(t[d],"</span>"))}});document.querySelector(".camp-reservation h2").addEventListener("click",(function(e){e.target.parentNode.classList.toggle("open"),document.body.classList.toggle("add-to-cart-open")})),document.querySelectorAll('[name="enfants[]"]').forEach((function(e){return e.addEventListener("click",(function(){debouceFetch()}))})),document.querySelector("#all-week").addEventListener("click",(function(){r.setDate(Array.from(document.querySelector("#valid-days").options).map((function(e){return e.value})),!0)})),document.querySelector("#all-week").addEventListener("click",(function(){r.setDate(Array.from(document.querySelector("#valid-days").options).map((function(e){return e.value})),!0)})),document.querySelector("#inscription").addEventListener("submit",(function(e){e.preventDefault()})),document.body.addEventListener("click",(function(e){"bouton-add-to-cart"==e.target.id&&addToCart()})),debouceFetch()}));var isFetchingPrice=!1,queueFetch=!1;function debouceFetch(){isFetchingPrice?queueFetch=!0:(clearTimeout(debounceFetchTimeout),debounceFetchTimeout=setTimeout(fetchAddToCart,250))}function fetchAddToCart(){document.querySelector("p.error").innerHTML="";var e=document.querySelector("#add-to-cart .loader");e.classList.remove("hide"),isFetchingPrice=!0,queueFetch=!1;var t=document.querySelector("#inscription"),n=new FormData(t),r={};n.forEach((function(e,t){Reflect.has(r,t)?(Array.isArray(r[t])||(r[t]=[r[t]]),r[t].push(e)):r[t]=e})),wp.apiFetch({path:"inscriptions/load-add-to-cart",method:"POST",data:r}).then((function(t){isFetchingPrice=!1,queueFetch?fetchAddToCart():(renderAddToCart(t),e.classList.add("hide"))}))}function renderAddToCart(e){var t=document.querySelector("#add-to-cart .inner"),n=document.querySelector("#add-to-cart .no-choice");if(!e.success)return t.classList.add("hide"),void n.classList.remove("hide");n.classList.add("hide"),t.classList.remove("hide"),t.innerHTML="",t.insertAdjacentHTML("afterbegin","\n        <h4><span>Prix:</span> <span>".concat(e.price,'$</span></h4>\n        <button id="bouton-add-to-cart" class="ins-btn">Ajouter au panier</button>\n    '))}function addToCart(){var e=document.querySelector("p.error"),t=document.querySelector("#add-to-cart .loader");t.classList.remove("hide"),isFetchingPrice=!0,queueFetch=!1;var n=document.querySelector("#inscription"),r=new FormData(n),c={};r.forEach((function(e,t){Reflect.has(c,t)?(Array.isArray(c[t])||(c[t]=[c[t]]),c[t].push(e)):c[t]=e})),wp.apiFetch({path:"inscriptions/add-to-cart",method:"POST",data:c}).then((function(n){t.classList.add("hide"),n.success?location.href=n.redirect:e.innerHTML=n.error}))}
//# sourceMappingURL=maps/camps.min.js.map
