var debounceFetchTimeout;document.addEventListener("DOMContentLoaded",(function(){initmap(),addPriceBracketTooltip();var e=Array.from(document.querySelector("#full-days").options).map((function(e){return e.value})),t={};function n(e){return("0"+e).slice(-2)}Array.from(document.querySelector("#valid-days").options).forEach((function(e){t[e.value]=e.innerHTML}));var c=flatpickr("#calendrier",{inline:!0,mode:"multiple",dateFormat:"Y-m-d",locale:"fr",enable:Array.from(document.querySelector("#valid-days").options).map((function(e){return e.value})),onChange:function(e,t,n){debouceFetch()},onDayCreate:function(c,a,o,r){var i=r.dateObj,d=i.getFullYear()+"-"+n(i.getMonth()+1)+"-"+n(i.getDate());-1!==e.indexOf(d)&&(r.className+=" date-full"),-1!==Object.keys(t).indexOf(d)&&r.insertAdjacentHTML("beforeEnd",'<span title="'.concat(t[d]," place").concat(t[d]>1?"s":""," disponible").concat(t[d]>1?"s":"",'.">').concat(t[d],"</span>"))},onReady:function(){this.config._enable.length>0?this.jumpToDate(this.config._enable[0]):e.length>0&&this.jumpToDate(e[0])}});document.querySelector(".camp-reservation h2").addEventListener("click",(function(e){e.target.parentNode.classList.toggle("open"),document.body.classList.toggle("add-to-cart-open")})),document.querySelectorAll('[name="enfants[]"]').forEach((function(e){return e.addEventListener("click",(function(){debouceFetch()}))})),document.querySelector("#all-week").addEventListener("click",(function(){c.setDate(Array.from(document.querySelector("#valid-days").options).map((function(e){return e.value})),!0)})),document.querySelector("#all-week").addEventListener("click",(function(){c.setDate(Array.from(document.querySelector("#valid-days").options).map((function(e){return e.value})),!0)})),document.querySelector("#inscription").addEventListener("submit",(function(e){e.preventDefault()})),document.body.addEventListener("click",(function(e){"bouton-add-to-cart"==e.target.id&&addToCart()})),debouceFetch()}));var isFetchingPrice=!1,queueFetch=!1;function debouceFetch(){isFetchingPrice?queueFetch=!0:(clearTimeout(debounceFetchTimeout),debounceFetchTimeout=setTimeout(fetchAddToCart,250))}function fetchAddToCart(){document.querySelector("p.error").innerHTML="";var e=document.querySelector("#add-to-cart .loader");e.classList.remove("hide"),isFetchingPrice=!0,queueFetch=!1;var t=document.querySelector("#inscription"),n=new FormData(t),c={};n.forEach((function(e,t){Reflect.has(c,t)?(Array.isArray(c[t])||(c[t]=[c[t]]),c[t].push(e)):c[t]=e})),wp.apiFetch({path:"inscriptions/load-add-to-cart",method:"POST",data:c}).then((function(t){isFetchingPrice=!1,queueFetch?fetchAddToCart():(renderAddToCart(t),e.classList.add("hide"))}))}function renderAddToCart(e){var t=document.querySelector("#add-to-cart .inner"),n=document.querySelector("#add-to-cart .no-choice");if(!e.success)return t.classList.add("hide"),void n.classList.remove("hide");n.classList.add("hide"),t.classList.remove("hide"),t.innerHTML="",t.insertAdjacentHTML("afterbegin","\n        <h4><span>Prix:</span> <span>".concat(e.price,'</span></h4>\n        <button id="bouton-add-to-cart" class="ins-btn">Ajouter au panier</button>\n        <p><small>Cumul des journées inscrites: ').concat(e.cumulative,"</small></p> \n    "));var c=document.querySelector(".selected_bracket");c&&c.classList.remove("selected_bracket");var a=document.querySelector('[data-bracket="'.concat(e.price_bracket,'"]'));a&&a.classList.add("selected_bracket")}function addToCart(){var e=document.querySelector("p.error"),t=document.querySelector("#add-to-cart .loader");t.classList.remove("hide"),isFetchingPrice=!0,queueFetch=!1;var n=document.querySelector("#inscription"),c=new FormData(n),a={};c.forEach((function(e,t){Reflect.has(a,t)?(Array.isArray(a[t])||(a[t]=[a[t]]),a[t].push(e)):a[t]=e})),wp.apiFetch({path:"inscriptions/add-to-cart",method:"POST",data:a}).then((function(n){t.classList.add("hide"),n.success?location.href=n.redirect:e.innerHTML=n.error}))}function initmap(){var e=document.getElementById("map");if(e){var t=parseFloat(e.getAttribute("data-lat")),n=parseFloat(e.getAttribute("data-lng")),c=(e.getAttribute("data-address"),new google.maps.Map(e,{zoom:16,center:{lat:t,lng:n},scrollwheel:!1,zoomControl:!0,disableDefaultUI:!0}));new google.maps.Marker({position:{lat:t,lng:n},map:c})}}function addPriceBracketTooltip(e){document.querySelectorAll("td i.fa-circle-info").forEach((function(e){new tippy(e,{interactive:!0,theme:"dark content-camp",allowHTML:!0,content:"Le prix est calculé selon le nombre de journée inscrite cumulative de l'année en cours.",placement:"top",zIndex:99999,appendTo:function(){return document.body}})}))}
//# sourceMappingURL=maps/camps.min.js.map
